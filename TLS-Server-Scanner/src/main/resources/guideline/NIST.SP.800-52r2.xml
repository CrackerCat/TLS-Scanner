<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<guideline>
    <name>NIST SP 800-52r2</name>
    <link>https://doi.org/10.6028/NIST.SP.800-52r2</link>
    <checks>
        <!-- TLS VERSIONS -->
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
            <description>
                Servers shall support TLS 1.2.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_3</analyzedProperty>
            <description>
                Servers should support TLS 1.3 and shall support TLS 1.3 by January 1, 2024.
            </description>
            <requirementLevel>SHOULD</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_0</analyzedProperty>
            <description>
                Support of TLS 1.0 is discouraged.
            </description>
            <requirementLevel>SHOULD_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_1</analyzedProperty>
            <description>
                Support of TLS 1.1 is discouraged.
            </description>
            <requirementLevel>SHOULD_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_SSL_3</analyzedProperty>
            <description>
                Servers shall not support SSL 3.0.
            </description>
            <requirementLevel>MUST_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_SSL_2</analyzedProperty>
            <description>
                Servers shall not support SSL 2.0.
            </description>
            <requirementLevel>MUST_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <!-- CERTIFICATE -->
        <!-- TODO -->
        <!-- MANDATORY TLS EXTENSIONS -->
        <check>
            <analyzedProperty>SUPPORTS_SECURE_RENEGOTIATION_EXTENSION</analyzedProperty>
            <description>
                The server shall support the use of the Renegotiation Indication extension.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>STRICT_SNI</analyzedProperty> <!-- todo -->
            <description>
                The server shall support the use of the Server Name Indication extension.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_EXTENDED_MASTER_SECRET</analyzedProperty>
            <description>
                The server shall support the use of the Extended Master Secret extension.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_CERTIFICATE_STATUS_REQUEST</analyzedProperty>
            <description>
                The server shall support the use of the Certificate Status Request extension.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <!-- CONDITIONAL TLS EXTENSIONS -->
        <check>
            <condition>
                <and>
                    <condition>
                        <or>
                            <condition>
                                <analyzedProperty>SUPPORTS_SSL_2</analyzedProperty>
                                <result>TRUE</result>
                            </condition>
                            <condition>
                                <analyzedProperty>SUPPORTS_SSL_3</analyzedProperty>
                                <result>TRUE</result>
                            </condition>
                            <condition>
                                <analyzedProperty>SUPPORTS_TLS_1_0</analyzedProperty>
                                <result>TRUE</result>
                            </condition>
                            <condition>
                                <analyzedProperty>SUPPORTS_TLS_1_1</analyzedProperty>
                                <result>TRUE</result>
                            </condition>
                        </or>
                    </condition>
                    <condition>
                        <analyzedProperty>SUPPORTS_TLS_1_3</analyzedProperty>
                        <result>FALSE</result>
                    </condition>
                </and>
            </condition>
            <analyzedProperty>SUPPORTS_TLS_FALLBACK_SCSV</analyzedProperty>
            <description>
                The Fallback Signaling Cipher Suite Value (SCSV) shall be supported if the server supports versions of
                TLS prior to TLS 1.2 and does not support TLS 1.3.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <condition>
                <analyzedProperty>SUPPORTS_CBC</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <analyzedProperty>SUPPORTS_ENCRYPT_THEN_MAC</analyzedProperty>
            <description>
                The Encrypt-then-MAC extension shall be supported if the server is configured to negotiate CBC
                cipher suites.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <condition>
                <analyzedProperty>SUPPORTS_OCSP</analyzedProperty><!-- TODO -->
                <result>TRUE</result>
            </condition>
            <analyzedProperty>SUPPORTS_CERTIFICATE_STATUS_REQUEST_V2</analyzedProperty>
            <description>
                The Multiple Certificate Status extension should be supported if status information for the serverâ€™s
                certificate is available via OCSP and the extension is supported by the server implementation
            </description>
            <requirementLevel>SHOULD</requirementLevel>
            <result>TRUE</result>
        </check>
        <!-- DISCOURAGED TLS EXTENSIONS -->
        <check>
            <analyzedProperty>SUPPORTS_TLS_COMPRESSION</analyzedProperty>
            <description>
                The null compression method shall be enabled, and all other compression methods shall be disabled.
            </description>
            <requirementLevel>MUST_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
    </checks>
    <cipherSuites>
        <cipherSuite>
            <versions>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_CCM</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_CCM</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS10</version>
                <version>TLS11</version>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_CCM</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_CCM</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_CCM_8</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_CCM_8</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS10</version>
                <version>TLS11</version>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_CBC_SHA</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_256_CBC_SHA256</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS10</version>
                <version>TLS11</version>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_256_CBC_SHA</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <!-- DSA Signed cert -->
                <cipherSuite>TLS_DH_DSS_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_256_CBC_SHA256</cipherSuite>
                <!-- RSA Signed cert -->
                <cipherSuite>TLS_DH_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_256_CBC_SHA256</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS10</version>
                <version>TLS11</version>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <!-- DSA SIGNED -->
                <cipherSuite>TLS_DH_DSS_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_256_CBC_SHA</cipherSuite>
                <!-- RSA SIGNED -->
                <cipherSuite>TLS_DH_RSA_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_256_CBC_SHA</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <!-- ECDSA Signed cert -->
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384</cipherSuite>
                <!-- RSA Signed cert -->
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS10</version>
                <version>TLS11</version>
                <version>TLS12</version>
            </versions>
            <cipherSuites>
                <!-- ECDSA SIGNED -->
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA</cipherSuite>
                <!-- RSA SIGNED -->
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_128_CBC_SHA</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_256_CBC_SHA</cipherSuite>
            </cipherSuites>
        </cipherSuite>
        <cipherSuite>
            <versions>
                <version>TLS13</version>
            </versions>
            <cipherSuites>
                <cipherSuite>TLS_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_AES_128_CCM_SHA256</cipherSuite>
                <cipherSuite>TLS_AES_128_CCM_8_SHA256</cipherSuite>
            </cipherSuites>
        </cipherSuite>
    </cipherSuites>
</guideline>
