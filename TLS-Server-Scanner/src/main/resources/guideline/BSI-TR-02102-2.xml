<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<guideline>
    <name>BSI TR-02102-2</name>
    <link>
        https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102-2.html
    </link>
    <checks>
        <!-- General Checks on Version -->
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>TLS 1.2 wird unterstüzt.</name>
            <description>Grundsätzlich werden TLS 1.2 und TLS 1.3 empfohlen.</description>
            <property>SUPPORTS_TLS_1_2</property>
            <result>TRUE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>TLS 1.3 wird unterstüzt.</name>
            <description>Grundsätzlich werden TLS 1.2 und TLS 1.3 empfohlen.</description>
            <property>SUPPORTS_TLS_1_3</property>
            <result>TRUE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>TLS 1.0 wird nicht unterstüzt.</name>
            <description>TLS 1.0 und TLS 1.1 werden nicht empfohlen.</description>
            <property>SUPPORTS_TLS_1_0</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>TLS 1.1 wird nicht unterstüzt.</name>
            <description>TLS 1.0 und TLS 1.1 werden nicht empfohlen.</description>
            <property>SUPPORTS_TLS_1_1</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>SSL v2 wird nicht unterstüzt.</name>
            <description>SSL v2 und SSL v3 werden nicht empfohlen.</description>
            <property>SUPPORTS_SSL_2</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>SSL v3 wird nicht unterstüzt.</name>
            <description>SSL v2 und SSL v3 werden nicht empfohlen.</description>
            <property>SUPPORTS_SSL_3</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <!-- TLS 1.2 Recommendations -->
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="cipherSuiteGuidelineCheck">
            <name>Unterstützte Cipher Suites TLS 1.2</name>
            <description>
                Grundsätzlich wird empfohlen, nur Cipher-Suiten einzusetzen, die die Anforderungen an die Algorithmen
                und Schlüssellängen der [TR-02102-1] erfüllen.
            </description>
            <requirementLevel>SHOULD</requirementLevel>
            <versions>TLS12</versions>
            <cipherSuites>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDHE_ECDSA_WITH_AES_128_CCM</cipherSuites>
            <cipherSuites>TLS_ECDHE_ECDSA_WITH_AES_256_CCM</cipherSuites>
            <cipherSuites>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_DHE_DSS_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_DSS_WITH_AES_256_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_DSS_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_DSS_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_DHE_RSA_WITH_AES_128_CCM</cipherSuites>
            <cipherSuites>TLS_DHE_RSA_WITH_AES_256_CCM</cipherSuites>

            <cipherSuites>TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_DH_DSS_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DH_DSS_WITH_AES_256_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DH_DSS_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_DH_DSS_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_DH_RSA_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DH_RSA_WITH_AES_256_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DH_RSA_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_DH_RSA_WITH_AES_256_GCM_SHA384</cipherSuites>

            <cipherSuites>TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_PSK_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_PSK_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_DHE_PSK_WITH_AES_128_CCM</cipherSuites>
            <cipherSuites>TLS_DHE_PSK_WITH_AES_256_CCM</cipherSuites>
            <cipherSuites>TLS_RSA_PSK_WITH_AES_128_CBC_SHA256</cipherSuites>
            <cipherSuites>TLS_RSA_PSK_WITH_AES_256_CBC_SHA384</cipherSuites>
            <cipherSuites>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384</cipherSuites>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="namedGroupsGuidelineCheck">
            <name>Named Groups</name>
            <description>Die folgenden Diffie-Hellman Gruppen werden empfohlen.</description>
            <requirementLevel>SHOULD</requirementLevel>
            <minGroups>2</minGroups>
            <groups>SECP256R1</groups>
            <groups>SECP384R1</groups>
            <groups>BRAINPOOLP256R1</groups>
            <groups>BRAINPOOLP384R1</groups>
            <groups>BRAINPOOLP512R1</groups>
            <groups>FFDHE2048</groups>
            <groups>FFDHE3072</groups>
            <groups>FFDHE4096</groups>
            <tls13>false</tls13>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="signatureAlgorithmsGuidelineCheck">
            <name>Signaturverfahren</name>
            <description>Die folgenden Signaturverfahren werden empfohlen.</description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <requirementLevel>SHOULD</requirementLevel>
            <algorithms>RSA</algorithms>
            <algorithms>DSA</algorithms>
            <algorithms>ECDSA</algorithms>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="hashAlgorithmsGuidelineCheck">
            <name>Hashfunktionen</name>
            <description>Die folgenden Hashfunktionen werden empfohlen.</description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <requirementLevel>SHOULD</requirementLevel>
            <algorithms>SHA256</algorithms>
            <algorithms>SHA384</algorithms>
            <algorithms>SHA512</algorithms>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>Secure Renegotiation Extension wird unterstüzt.</name>
            <description>
                Es wird empfohlen Session Renegotiation nur auf Basis von [RFC5746] zu verwenden. Durch den
                Client initiierte Renegotiation sollte vom Server abgelehnt werden.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_SECURE_RENEGOTIATION_EXTENSION</property>
            <result>TRUE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>Client Secure Renegotiation Extension wird nicht unterstüzt.</name>
            <description>
                Es wird empfohlen Session Renegotiation nur auf Basis von [RFC5746] zu verwenden. Durch den
                Client initiierte Renegotiation sollte vom Server abgelehnt werden.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_CLIENT_SIDE_SECURE_RENEGOTIATION_EXTENSION</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>Client Secure Renegotiation Extension wird nicht unterstüzt.</name>
            <description>
                Es wird empfohlen Session Renegotiation nur auf Basis von [RFC5746] zu verwenden. Durch den
                Client initiierte Renegotiation sollte vom Server abgelehnt werden.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_CLIENT_SIDE_INSECURE_RENEGOTIATION</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="extensionGuidelineCheck">
            <name>truncated_hmac</name>
            <description>truncated_hmac sollte nicht unterstüzt werden.</description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <requirementLevel>SHOULD_NOT</requirementLevel>
            <extension>TRUNCATED_HMAC</extension>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>TLS Compression wird nicht unterstüzt.</name>
            <description>
                Es wird empfohlen die TLS-Datenkompression nicht zu verwenden.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_TLS_COMPRESSION</property>
            <result>FALSE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>„Encrypt-then-MAC“ wird unterstüzt.</name>
            <description>
                Der Einsatz der TLS-Erweiterung „Encrypt-then-MAC“ gemäß [RFC7366] wird empfohlen.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_ENCRYPT_THEN_MAC</property>
            <result>TRUE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="extensionGuidelineCheck">
            <name>Heartbeat</name>
            <description>Heartbeat sollte nicht unterstüzt werden.</description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <requirementLevel>SHOULD_NOT</requirementLevel>
            <extension>HEARTBEAT</extension>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>Extended Master Secret wird unterstüzt.</name>
            <description>
                Der Einsatz der TLS-Erweiterung Extended Master Secret gemäß [RFC7627] wird empfohlen.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_EXTENDED_MASTER_SECRET</property>
            <result>TRUE</result>
            <requirementLevel>SHOULD</requirementLevel>
        </check>
        <!-- TLS 1.3 Recommendations -->
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="analyzedPropertyGuidelineCheck">
            <name>Das Senden oder Annehmen von 0-RTT Daten wird nicht empfohlen.</name>
            <description>
                Das Senden oder Annehmen von 0-RTT Daten wird nicht empfohlen.
            </description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_3</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <property>SUPPORTS_TLS13_0_RTT</property>
            <result>TRUE</result>
            <requirementLevel>SHOULD_NOT</requirementLevel>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="namedGroupsGuidelineCheck">
            <name>Named Groups</name>
            <description>Die folgenden Diffie-Hellman Gruppen werden empfohlen.</description>
            <requirementLevel>SHOULD</requirementLevel>
            <groups>SECP256R1</groups>
            <groups>SECP384R1</groups>
            <groups>BRAINPOOLP256R1TLS13</groups>
            <groups>BRAINPOOLP384R1TLS13</groups>
            <groups>BRAINPOOLP512R1TLS13</groups>
            <groups>FFDHE2048</groups>
            <groups>FFDHE3072</groups>
            <groups>FFDHE4096</groups>
            <tls13>true</tls13>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:type="signatureAndHashAlgorithmsGuidelineCheck">
            <name>Signaturverfahren</name>
            <description>Die folgenden Signaturverfahren werden empfohlen.</description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_3</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <requirementLevel>SHOULD</requirementLevel>
            <algorithms>RSA_PSS_RSAE_SHA256</algorithms>
            <algorithms>RSA_PSS_RSAE_SHA384</algorithms>
            <algorithms>RSA_PSS_RSAE_SHA512</algorithms>
            <algorithms>RSA_PSS_PSS_SHA256</algorithms>
            <algorithms>RSA_PSS_PSS_SHA384</algorithms>
            <algorithms>RSA_PSS_PSS_SHA512</algorithms>
            <algorithms>ECDSA_SHA256</algorithms>
            <algorithms>ECDSA_SHA384</algorithms>
            <algorithms>ECDSA_BRAINPOOLP256R1TLS13_SHA256</algorithms>
            <algorithms>ECDSA_BRAINPOOLP384R1TLS13_SHA384</algorithms>
            <algorithms>ECDSA_BRAINPOOLP512R1TLS13_SHA512</algorithms>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:type="signatureAndHashAlgorithmsCertGuidelineCheck">
            <name>Signaturverfahren Zertifikat</name>
            <description>Die folgenden Signaturverfahren werden empfohlen.</description>
            <condition>
                <analyzedProperty>SUPPORTS_TLS_1_3</analyzedProperty>
                <result>TRUE</result>
            </condition>
            <requirementLevel>SHOULD</requirementLevel>
            <algorithms>RSA_SHA256</algorithms>
            <algorithms>RSA_SHA384</algorithms>
            <algorithms>RSA_SHA512</algorithms>
            <algorithms>RSA_PSS_RSAE_SHA256</algorithms>
            <algorithms>RSA_PSS_RSAE_SHA384</algorithms>
            <algorithms>RSA_PSS_RSAE_SHA512</algorithms>
            <algorithms>RSA_PSS_PSS_SHA256</algorithms>
            <algorithms>RSA_PSS_PSS_SHA384</algorithms>
            <algorithms>RSA_PSS_PSS_SHA512</algorithms>
            <algorithms>ECDSA_SHA256</algorithms>
            <algorithms>ECDSA_SHA384</algorithms>
            <algorithms>ECDSA_BRAINPOOLP256R1TLS13_SHA256</algorithms>
            <algorithms>ECDSA_BRAINPOOLP384R1TLS13_SHA384</algorithms>
            <algorithms>ECDSA_BRAINPOOLP512R1TLS13_SHA512</algorithms>
        </check>
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="cipherSuiteGuidelineCheck">
            <name>Unterstützte Cipher Suites TLS 1.3</name>
            <description>
                Die folgenden Cipher-Suiten werden empfohlen.
            </description>
            <requirementLevel>SHOULD</requirementLevel>
            <versions>TLS13</versions>
            <cipherSuites>TLS_AES_128_GCM_SHA256</cipherSuites>
            <cipherSuites>TLS_AES_256_GCM_SHA384</cipherSuites>
            <cipherSuites>TLS_AES_128_CCM_SHA256</cipherSuites>
        </check>
        <!-- Key Sizes -->
        <check xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="keySizeCertGuidelineCheck">
            <name>Schlüssellängen</name>
            <description>Schlüssellängen</description>
            <requirementLevel>SHOULD</requirementLevel>
            <ec>250</ec>
            <dsa>2000</dsa>
            <rsa>2000</rsa>
            <dh>2000</dh>
        </check>
    </checks>
</guideline>
