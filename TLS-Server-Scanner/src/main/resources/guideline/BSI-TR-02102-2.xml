<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<guideline>
    <name>BSI TR-02102-2</name>
    <link>
        https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102-2.html
    </link>
    <checks>
        <!-- TLS VERSIONS -->
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_2</analyzedProperty>
            <description>
                Servers shall support TLS 1.2.
            </description>
            <requirementLevel>MUST</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_3</analyzedProperty>
            <description>
                Servers should support TLS 1.3 and shall support TLS 1.3 by January 1, 2024.
            </description>
            <requirementLevel>SHOULD</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_0</analyzedProperty>
            <description>
                Support of TLS 1.0 is discouraged.
            </description>
            <requirementLevel>SHOULD_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_TLS_1_1</analyzedProperty>
            <description>
                Support of TLS 1.1 is discouraged.
            </description>
            <requirementLevel>SHOULD_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_SSL_3</analyzedProperty>
            <description>
                Servers shall not support SSL 3.0.
            </description>
            <requirementLevel>MUST_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
        <check>
            <analyzedProperty>SUPPORTS_SSL_2</analyzedProperty>
            <description>
                Servers shall not support SSL 2.0.
            </description>
            <requirementLevel>MUST_NOT</requirementLevel>
            <result>TRUE</result>
        </check>
    </checks>
    <versionDependant>
        <guideline>
            <versions>
                <version>TLS12</version>
            </versions>
            <checks>
                <check>
                    <analyzedProperty>SUPPORTS_SECURE_RENEGOTIATION_EXTENSION</analyzedProperty>
                    <description>
                        Es wird empfohlen Session Renegotiation nur auf Basis von [RFC5746] zu verwenden. Durch den
                        Client initiierte Renegotiation sollte vom Server abgelehnt werden.
                    </description>
                    <requirementLevel>SHOULD</requirementLevel>
                    <result>TRUE</result>
                </check>
                <check>
                    <analyzedProperty>SUPPORTS_CLIENT_SIDE_SECURE_RENEGOTIATION_EXTENSION</analyzedProperty>
                    <description>
                        Es wird empfohlen Session Renegotiation nur auf Basis von [RFC5746] zu verwenden. Durch den
                        Client initiierte Renegotiation sollte vom Server abgelehnt werden.
                    </description>
                    <requirementLevel>SHOULD_NOT</requirementLevel>
                    <result>TRUE</result>
                </check>
                <check>
                    <analyzedProperty>SUPPORTS_TLS_COMPRESSION</analyzedProperty>
                    <description>
                        Es wird empfohlen die TLS-Datenkompression nicht zu verwenden.
                    </description>
                    <requirementLevel>SHOULD_NOT</requirementLevel>
                    <result>TRUE</result>
                </check>
                <check>
                    <analyzedProperty>SUPPORTS_ENCRYPT_THEN_MAC</analyzedProperty>
                    <description>
                        Der Einsatz der TLS-Erweiterung „Encrypt-then-MAC“ gemäß [RFC7366] wird empfohlen.
                    </description>
                    <requirementLevel>SHOULD</requirementLevel>
                    <result>TRUE</result>
                </check>
                <check>
                    <analyzedProperty>SUPPORTS_EXTENDED_MASTER_SECRET</analyzedProperty>
                    <description>
                        Der Einsatz der TLS-Erweiterung Extended Master Secret gemäß [RFC7627] wird empfohlen.
                    </description>
                    <requirementLevel>SHOULD</requirementLevel>
                    <result>TRUE</result>
                </check>
            </checks>
            <extensions>
                <extension>
                    <type>TRUNCATED_HMAC</type>
                    <requirementLevel>SHOULD_NOT</requirementLevel>
                </extension>
                <extension>
                    <type>HEARTBEAT</type>
                    <requirementLevel>SHOULD_NOT</requirementLevel>
                </extension>
            </extensions>
            <cipherSuites>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_128_CCM</cipherSuite>
                <cipherSuite>TLS_ECDHE_ECDSA_WITH_AES_256_CCM</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_256_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_DSS_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_128_CCM</cipherSuite>
                <cipherSuite>TLS_DHE_RSA_WITH_AES_256_CCM</cipherSuite>

                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_256_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_DSS_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_256_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DH_RSA_WITH_AES_256_GCM_SHA384</cipherSuite>

                <cipherSuite>TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_PSK_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_PSK_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_DHE_PSK_WITH_AES_128_CCM</cipherSuite>
                <cipherSuite>TLS_DHE_PSK_WITH_AES_256_CCM</cipherSuite>
                <cipherSuite>TLS_RSA_PSK_WITH_AES_128_CBC_SHA256</cipherSuite>
                <cipherSuite>TLS_RSA_PSK_WITH_AES_256_CBC_SHA384</cipherSuite>
                <cipherSuite>TLS_RSA_PSK_WITH_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_RSA_PSK_WITH_AES_256_GCM_SHA384</cipherSuite>
            </cipherSuites>
            <namedGroups>
                <namedGroup>SECP256R1</namedGroup>
                <namedGroup>SECP384R1</namedGroup>
                <namedGroup>BRAINPOOLP256R1</namedGroup>
                <namedGroup>BRAINPOOLP384R1</namedGroup>
                <namedGroup>BRAINPOOLP512R1</namedGroup>
                <namedGroup>FFDHE2048</namedGroup>
                <namedGroup>FFDHE3072</namedGroup>
                <namedGroup>FFDHE4096</namedGroup>
            </namedGroups>
            <signatureAlgorithms>
                <signatureAlgorithm>RSA</signatureAlgorithm>
                <signatureAlgorithm>DSA</signatureAlgorithm>
                <signatureAlgorithm>ECDSA</signatureAlgorithm>
            </signatureAlgorithms>
            <hashAlgorithms>
                <hashAlgorithm>SHA256</hashAlgorithm>
                <hashAlgorithm>SHA384</hashAlgorithm>
                <hashAlgorithm>SHA512</hashAlgorithm>
            </hashAlgorithms>
        </guideline>
        <guideline>
            <versions>
                <version>TLS13</version>
            </versions>
            <checks>
                <check>
                    <analyzedProperty>SUPPORTS_TLS13_0_RTT</analyzedProperty>
                    <description>
                        Das Senden oder Annehmen von 0-RTT Daten wird nicht empfohlen.
                    </description>
                    <requirementLevel>SHOULD_NOT</requirementLevel>
                    <result>TRUE</result>
                </check>
            </checks>
            <cipherSuites>
                <cipherSuite>TLS_AES_128_GCM_SHA256</cipherSuite>
                <cipherSuite>TLS_AES_256_GCM_SHA384</cipherSuite>
                <cipherSuite>TLS_AES_128_CCM_SHA256</cipherSuite>
            </cipherSuites>
            <namedGroups>
                <namedGroup>SECP256R1</namedGroup>
                <namedGroup>SECP384R1</namedGroup>
                <namedGroup>BRAINPOOLP256R1TLS13</namedGroup>
                <namedGroup>BRAINPOOLP384R1TLS13</namedGroup>
                <namedGroup>BRAINPOOLP512R1TLS13</namedGroup>
                <namedGroup>FFDHE2048</namedGroup>
                <namedGroup>FFDHE3072</namedGroup>
                <namedGroup>FFDHE4096</namedGroup>
            </namedGroups>
            <signatureAndHashAlgorithms>
                <signatureAndHashAlgorithm>RSA_PSS_RSAE_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_RSAE_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_RSAE_SHA512</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_PSS_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_PSS_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_PSS_SHA512</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_BRAINPOOLP256R1TLS13_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_BRAINPOOLP384R1TLS13_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_BRAINPOOLP512R1TLS13_SHA512</signatureAndHashAlgorithm>
            </signatureAndHashAlgorithms>
            <signatureAndHashAlgorithmsCert>
                <signatureAndHashAlgorithm>RSA_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_SHA512</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_RSAE_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_RSAE_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_RSAE_SHA512</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_PSS_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_PSS_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>RSA_PSS_PSS_SHA512</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_BRAINPOOLP256R1TLS13_SHA256</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_BRAINPOOLP384R1TLS13_SHA384</signatureAndHashAlgorithm>
                <signatureAndHashAlgorithm>ECDSA_BRAINPOOLP512R1TLS13_SHA512</signatureAndHashAlgorithm>
            </signatureAndHashAlgorithmsCert>
        </guideline>
    </versionDependant>
</guideline>
